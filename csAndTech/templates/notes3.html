{% extends "layout.html" %}
{% block tytle %}
Заметки 3
{% endblock %}

{% block body %}
<h1>Javascript</h1>
<p>Для выполнения программ мы будем использовать nodejs.
Создайте файл из примера ниже, сохраните его в файле
test.js. Перейдите в консоль и выполните
</p>
<pre>
<code>
node test.js
</code>
</pre>
Javascript код можно выполнить в консоли браузера,
для этого в браузере надо нажать клавишу <kbd>F12</kbd>,
в открывшемся наборе инструментов разработчика выбрать
консоль и в ней ввести код.
<p>Программа на javascript - 
это последовательность инструкции.
Инструкции разделяются точкой с запятой или
начинают с разных строк.
В состав инструкций могут входить выражения.
Выражения возвращают значения.
Например,
</p>
<pre>
<code>
let r = 5.4;
let area = Math.PI * r**2;
console.log(area);
</code>
</pre>
<p>
Первая и вторая инструкции объявляют переменные.
Последняя печатает в консоль значение переменной.
</p>
<p>По умолчанию инструкции выполняются по
порядку расположения в тексте. Для изменения порядка
выполнения используют инструкции контроля: ветвления,
циклы, переходы.</p>
<p>Рассмотрим инструкции объявления,
они объявляют или определяют переменные и 
функции. Они вводят имя которое будет использоваться
позже и присваивают ему значение.
В примере выше, в первой строке, мы имеем литерное
высказывание <kbd>5.4</kbd>, оно прямо вводит числовое значение. 
Во второй строке, с права
от знака равно, находится высказывание, содержащее оператор умножения,
возведение в степень и переменные.
</p>
<h2>Числа</h2>
number- тип значений встроенный. Пример,
<pre>
<code>
console.log("25 * 5 =", 25 * 5)
console.log("5 % 2 =", 5 % 2)
let x = 5
console.log("x < 6 =", x < 6)
console.log("x**5 = ", x**6)//возводим в степень целую
console.log("sqrt(25)=", Math.sqrt(25))//Находим корень квадратный
console.log("корень кубический из 8 =", Math.pow(8, 1/3))//вычисляем степени
console.log("sin(pi/2) = ", Math.sin(Math.PI /2))
let x = parseFloat("3.14")//преобразуем строку текста в число
console.log(typeof x) // typeof возвращает тип значения
</code>
</pre>
<h2>Строки</h2>
Встроенный тип значений - string. Пример,
<pre>
<code>
let name = "Bob" //строковая литерал
console.log(`Hello, ${name}!`)//в строку подставляется значение переменной
</code>
</pre>

<h2>Логический тип</h2>
В логическом типе всего два значения: ture, false.
На них заданны операции: || (и), && (или), ! (отрицание).
Пример,
<pre>
<code>
let x = 5
console.log("x < 6 || x >3 ", x < 6 || x > 3) 
console.log("!(x < 6) = ", !(x < 6))
</code>
</pre>
<h2>Задание ветвления</h2>
Пример,
<pre>
<code>
let x = 5
if (x % 2 == 0)
{
	console.log(`${x} - четное`)
}
else
{
	console.log(`${x} - нечетное`)
}
</code>
</pre>

<h2>Циклы</h2>
Пример,
<pre>
<code>
for(let i = 0; i < 5;++)
{
	console.log(i)
}
</code>
</pre>
<h2>Массивы</h2>
Пример,
<pre>
<code>
let l = [1, 5, "Bob", 6] //литерал массива
l.push(9)//Добавляет новый элемент в конец массива
for (let i = 0; i < l.length; i++)
{
console.log(`l[${i}]=${l[i]}`)
}
l.reverse()//меняет порядок элементов
console.log(l)
let l2 = l.slice(1, 4)//создает новый массив с элементами с первого по 3 
console.log(l2)
</code>
</pre>

<h2>Функции</h2>
В первой строке следующего примера мы используем 
выражение, вычисляемое в значение
типа функция, и его присваиваем переменной. 
Во второй  строке мы используем
инструкцию, объявляющую  функцию. В третей стоке мы используем выражение,
вызывающее функцию и печатаем его результат.
<pre>
<code>
let f2 = function (x) { return x * 2}
function f3(x){return x * 3}
console.log(f2(5))
</code>
</pre>

<h2>Объекты</h2>
Объект состоит из пар ключ, значение.
Чтобы получить значение свойства объекта, 
можно использовать точку, или квадратные скобки. 
В следующем примере мы создаём объект, используя литеру объекта.
<pre>
<code>
let person = {name: "Лена", age: 18}//Создали объект
console.log("Привет, ", person.name, "!")
console.log("Привет, ", person["name"], "!")
</code>
</pre>

<h2>API веб браузера</h2>
Код на языке javascript вставляем при помощи элемента script.
Для загруженной странички
браузер создаёт DOM(Document Object Model), 
в языке javascript браузер
предоставляет инструменты (API)
для динамического изменения страницы. 
Создадим файл hello.html
<pre>
<code id ="hello_html">
</code>
</pre>
	<script>
		fetch("static/week3/hello.html")
		.then(responce => responce.text())
		.then(data=>{
			let hello_html = document.querySelector("#hello_html")
			hello_html.innerText = data
		})
	</script>
<p>Файл hello.js</p>
<pre>
<code id ="hello_js">
</code>
</pre>
	<script>
		fetch("static/week3/hello.js")
		.then(responce => responce.text())
		.then(data=>{
			let hello_js = document.querySelector("#hello_js")
			hello_js.innerText = data
		})
	</script>
<h2>Использование API сервера</h2>
fetch используем для запроса в асинхронном режиме данных
с сайта. Эта функция возвращает объект обещание. Ниже приведён 
пример
использования функции для запроса информации об отношении 
валют.
<pre>
<code id ="exchange_html">
</code>
</pre>
	<script>
		fetch("static/week3/exchange.html")
		.then(responce => responce.text())
		.then(data=>{
			let exchange_html = document.querySelector("#exchange_html")
			exchange_html.innerText = data
		})
	</script>
<p>Файл exchange.js</p>
<pre>
<code id ="exchange_js">
</code>
</pre>
<script>
		fetch("static/week3/exchange.js")
		.then(responce => responce.text())
		.then(data=>{
			let exchange_js = document.querySelector("#exchange_js")
			exchange_js.innerText = data
		})
</script>

<p>Рассмотрим второй способ работы с обещнаниемя</p>
<pre>
<code id ="exchange2_js">
</code>
</pre>

<script>
		fetch("static/week3/exchange2.js")
		.then(responce => responce.text())
		.then(data=>{
			let exchange2_js = document.querySelector("#exchange2_js")
			exchange2_js.innerText = data
		})
</script>

<h2>Веб сервер</h2>
Создайте файл server.js с текстом приведенным ниже,
выполните в косоле node server.js. Просмотрите страцину
в браузере.
<pre>
<code>
const http = require("http")
const server = http.createServer()

server.on('request', requestHandler)
server.listen(8080)

function requestHandler(req, res)
	{
		res.writeHead(200, {"Content-Type":"text/plain"})
		res.write("Hello, World!")
		res.end()
	}
</code>
</pre>
<p>В этом примере мы используем модуль http.
Создаём сервер, к событию сервера request назначаем
функцию requestHandler. Эта функция отправляет http заголовок,
в котором указывает код 200 (страница найдена), и что содержимое
тела будет текст, тело ответа содержит приветствие. </p>
<p>В следущем примере, в зависмости от ардеса запроса, мы отпраляем
текст или json данные.
<pre>
<code>
const http = require("http")
const server = http.createServer()

server.on('request', requestHandler)
server.listen(8080)

function requestHandler(req, res)
	{
		if( req.url == "/")
		{
			res.writeHead(200, {"Content-Type":"text/plain"})
			res.write("Hello, World!")
			res.end()
		}
		else if( req.url == "/api")
		{
			res.writeHead(200, {"Constent-Type": "application/json"})
			let person = {name: "Bob", age: 18}
			res.write(JSON.stringify(person))
			res.end()
		}
		else
		{
			res.writeHead(400)
			res.end("Page not found")
		}
	}
</code>
</pre>
В следующем примере мы загружаем страницу из файла.
<pre>
<code>
const fs = require('fs')
const http = require('http')

const server = http.createServer()
server.on("request", handler)
server.listen(8080)

function handler(req, res)
{
	fs.readFile("./file.html",
		function(err, data)
		{
			if(err){
				res.writeHead(500)
				res.write(err.message)
				res.end()
			}
			else{
				res.writeHead(200, {"Content-Type":"text/html"})
				res.write(data)
				res.end()
			}
		})
}
</code>
</pre>
{% endblock %}
